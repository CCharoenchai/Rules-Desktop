<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="https://www.thailife.com/public/assets/images/LOGO-THAILIFE.jpg" type="image/x-icon">
  <title>Consulting Services Forms</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
        .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }

    /* Style for the confirmation box */
    .confirm-box {
        background: white;
        border-radius: 5px;
        padding: 20px;
        text-align: center;
        width: 400px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .confirm-box h2 {
        margin: 0 0 20px;
        font-size: 18px;
    }

    .confirm-box button {
        margin: 0 10px;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .confirm-box .confirm {
        background-color: #4CAF50; /* Green */
        color: white;
    }

    .confirm-box .cancel {
        background-color: #f44336; /* Red */
        color: white;
    }
    /* การตั้งค่าสไตล์ทั่วไป */
    body {
      font-family: Thai Serif, Serif; /* ตั้งค่าฟอนต์สำหรับทั้งหน้า */
      background-color: #fff; /* สีพื้นหลังของหน้า */
      color: #263238; /* สีข้อความของหน้า */
      margin: 0; /* ลบระยะห่า00งขอบออก */
      padding: 0; /* ลบการเว้นระยะห่างภายในออก */
      text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1); /* ใส่เงา */
      border: 1px solid black; /* เส้นขอบสีดำ */
    }
    h1, h3 ,h5 ,h6{
      text-align: center; /* จัดกึ่งกลางหัวเรื่องหลัก */
      font-weight: bold; /* ทำให้หัวเรื่องหลักเป็นตัวหนา */
      color: #263238; /* สีข้อความของหัวเรื่องหลัก */
      margin: 20px; /* ระยะห่างรอบหัวเรื่องหลัก */
      text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2); /* ใส่เงา */
    }
    .head {
      width: 95%; /* กว้างของคอนเทนเนอร์เป็น 95% ของหน้าจอ */
      max-width: 1700px; /* ความกว้างสูงสุดของคอนเทนเนอร์ */
      margin: 0 auto; /* จัดกลางคอนเทนเนอร์ในแนวนอน */
      display: flex; /* ใช้ Flexbox */
      align-items: center; /* จัดกลางในแนวตั้ง */
      justify-content: center; /* จัดกลางในแนวนอน */
      text-align: center; /* จัดข้อความให้อยู่ตรงกลางในแนวนอน */
    }

    .head img {
      margin-right: 10px; /* เพิ่มพื้นที่ระหว่างรูปภาพและหัวข้อ (ปรับเปลี่ยนตามต้องการ) */
    }

    .head h1 {
      margin: 0; /* ลบ margin ของหัวข้อ */
    }

    .container-fluid-1 {
      width: 95%; /* กว้างของคอนเทนเนอร์เป็น 95% ของหน้าจอ */
      max-width: 1700px; /* ความกว้างสูงสุดของคอนเทนเนอร์ */
      margin: 0 auto; /* จัดกลางคอนเทนเนอร์ในแนวนอน */
      padding: 20px; /* การเว้นระยะห่างภายในคอนเทนเนอร์ */
      background-color: #e1f5fe; /* สีพื้นหลังของคอนเทนเนอร์ฟอร์ม */
      border-radius: 10px; /* มุมโค้งของคอนเทนเนอร์ */
      border: 1px solid #dddddd; /* ใส่เส้นกรอบ */
      box-shadow: 3px 5px 5px rgba(0, 0, 0, 0.9); /* ใส่เงา */
    }
    .container-fluid-2 {
      width: 95%; /* กว้างของคอนเทนเนอร์เป็น 95% ของหน้าจอ */
      max-width: 1700px; /* ความกว้างสูงสุดของคอนเทนเนอร์ */
      margin: 0 auto; /* จัดกลางคอนเทนเนอร์ในแนวนอน */
      padding: 20px; /* การเว้นระยะห่างภายในคอนเทนเนอร์ */
      background-color: #fffde7; /* สีพื้นหลังของคอนเทนเนอร์ฟอร์ม */
      border-radius: 10px; /* มุมโค้งของคอนเทนเนอร์ */
      border: 1px solid #dddddd; /* ใส่เส้นกรอบ */
      box-shadow: 3px 5px 5px rgba(0, 0, 0, 0.9); /* ใส่เงา */
    }
    .container-fluid-3 {
      width: 95%; /* กว้างของคอนเทนเนอร์เป็น 95% ของหน้าจอ */
      max-width: 1700px; /* ความกว้างสูงสุดของคอนเทนเนอร์ */
      margin: 0 auto; /* จัดกลางคอนเทนเนอร์ในแนวนอน */
      padding: 20px; /* การเว้นระยะห่างภายในคอนเทนเนอร์ */
      background-color: #e7e9fd; /* สีพื้นหลังของคอนเทนเนอร์ฟอร์ม */
      border-radius: 10px; /* มุมโค้งของคอนเทนเนอร์ */
      border: 1px solid #dddddd; /* ใส่เส้นกรอบ */
      box-shadow: 3px 5px 5px rgba(0, 0, 0, 0.9); /* ใส่เงา */
    }
    label {
      display: block; /* แสดงป้ายเป็นบล็อก */
      margin: 10px 0 10px; /* ระยะห่างรอบป้าย */
      font-weight: bold; /* ทำให้หัวเรื่องหลักเป็นตัวหนา */
      color: #263238; /* สีข้อความของป้าย */
    }
    .form-control {
      background-color: #fff; /* สีพื้นหลังของฟิลด์ป้อนข้อมูล */
      color: #000; /* สีข้อความของฟิลด์ป้อนข้อมูล */
      box-shadow: 3px 5px 5px rgba(0, 0, 0, 0.5); /* ใส่เงา */
      border: 1px solid black; /* เส้นขอบสีดำ */
    }
    .form-control:focus {
      border-color: #78909c; /* สีของกรอบเมื่อฟิลด์ป้อนข้อมูลถูกเลือก */
      box-shadow: 0 0 0 0.2rem rgba(26, 188, 156, 0.25); /* เงาสำหรับฟิลด์ป้อนข้อมูลที่ถูกเลือก */
    }
    button {
      color: #fff; /* สีข้อความของปุ่ม */
      border: 2px; /* ลบขอบของปุ่มออก */
      padding: 10px 20px; /* การเว้นระยะห่างภายในปุ่ม */
      border-radius: 5px; /* มุมโค้งของปุ่ม */
      cursor: pointer; /* เปลี่ยนเคอร์เซอร์เป็นรูปมือเมื่อชี้ที่ปุ่ม */
      font-size: 16px; /* ขนาดฟอนต์ของข้อความในปุ่ม */
      margin: 10px; /* ระยะห่างรอบปุ่ม */
      box-shadow: 3px 5px 5px rgba(0, 0, 0, 0.5); /* ใส่เงา */
      font-weight: bold; /* ทำให้ข้อความในปุ่มเป็นตัวหนา */
      border: 1px solid black; /* เส้นขอบสีดำ */
    }
    button:hover {
      opacity: 0.8; /* ลดความทึบลงเล็กน้อยเมื่อชี้ที่ปุ่ม */
    }
    #search {
      background-color: #283593; /* สีพื้นหลังของปุ่มค้นหา */
      width: 100px; /* ปรับความกว้าง */
      height: 50px; /* ปรับความสูง */
    }
    #clear {
      background-color: #e74c3c; /* สีพื้นหลังของปุ่มล้างข้อมูล */
      width: 200px; /* ปรับความกว้าง */
      height: 50px; /* ปรับความสูง */
    }
    #update {
      background-color: #ef6c00; /* สีพื้นหลังของปุ่มอัพเดต */
      width: 200px; /* ปรับความกว้าง */
      height: 50px; /* ปรับความสูง */
    }
    #submit {
      background-color: #0a8f08; /* สีพื้นหลังของปุ่มบันทึก */
      width: 200px; /* ปรับความกว้าง */
      height: 50px; /* ปรับความสูง */
    }
    .button-container {
        /* จัดกึ่งกลางปุ่มในคอนเทนเนอร์ */
      text-align: center; 
      /* margin-top: 20px; ระยะห่างด้านบนของคอนเทนเนอร์ปุ่ม */
    }
    .mid {
    text-align: center; /* จัดข้อความให้อยู่ตรงกลางในแนวนอน */
    /* จัดข้อความให้อยู่ตรงกลางในแนวตั้ง */
    vertical-align: middle; 
    font-weight: bold
    }
  </style>
</head>
<body>
    <script>
        function showSubmitBox() {
          document.getElementById('confirm-overlay-save').style.display = 'flex';
        }
        function confirmSaubmit() {
            document.getElementById('confirm-overlay-save').style.display = 'none';
            submit(); // เรียกใช้ฟังก์ชัน submit ถ้าผู้ใช้คลิก 'ยืนยัน'
        }
    
        function cancelSubmit() {
            document.getElementById('confirm-overlay-save').style.display = 'none'; // ซ่อนกล่องยืนยันถ้าผู้ใช้คลิก 'ยกเลิก'
        }
    
      function submit(){
        // ดึงค่าจาก input elements
        // let tx1 = document.querySelector('#Plan_ID').value;
        let Email = document.querySelector('#Email').value;
        let Type = document.querySelector('#Type').value;
        let Priority = document.querySelector('#Priority').value;
        let Branch = document.querySelector('#Branch').value; 
        let Province = document.querySelector('#Province').value; 
        let Date = document.querySelector('#Date').value; 
        let Channel = document.querySelector('#Channel').value; 
        let Requestor = document.querySelector('#Requestor').value; 
        let IA = document.querySelector('#IA').value; 
        let Team = document.querySelector('#Team').value; 
        let Owner = document.querySelector('#Owner').value; 
        let Complaint = document.querySelector('#Complaint').value; 
        let Description = document.querySelector('#Description').value;
    
        let Assign = document.querySelector('#Assign').value; 
        let AuditObjective = document.querySelector('#AuditObjective').value; 
        let Deadline = document.querySelector('#Deadline').value; 
        let FieldWork = document.querySelector('#FieldWork').value; 
        let DraftReport = document.querySelector('#DraftReport').value; 
        let ReportReview = document.querySelector('#ReportReview').value; 
        let FinalReport = document.querySelector('#FinalReport').value; 
        let Notify = document.querySelector('#Notify').value; 
        
        let Result = document.querySelector('#Result').value; 
        let Issue = document.querySelector('#Issue').value; 
    
        var sd = [Email, Type, Priority, Branch, Province, Date, Channel, Requestor, IA, Team, Owner, Complaint, Description, AuditObjective, Deadline,"","","","","","", Assign,"","", FieldWork,"","", DraftReport,"","", ReportReview,"","", FinalReport,"","", Notify,"", Result, Issue]; // ส่งข้อมูลเป็นอาร์เรย์
        
        let info = document.querySelector('#result'); // ดึง element ที่ใช้แสดงผลลัพธ์
        let info2 = document.querySelector('#result2'); // ดึง element ที่ใช้แสดงผลลัพธ์
        info.innerHTML = "กำลังบันทึกข้อมูล..."; // แสดงข้อความว่า "กำลังเพิ่มข้อมูลใหม่"
        info2.innerHTML = "กำลังบันทึกข้อมูล..."; // แสดงข้อความว่า "กำลังเพิ่มข้อมูลใหม่"
    
        // ฟังก์ชันจัดการเมื่อเกิดข้อผิดพลาด
        function onFailure(error){
          info.innerHTML = "<span style='color:red'>" + error + "</span>"; // แสดงข้อผิดพลาดเป็นสีแดง
          info2.innerHTML = "<span style='color:red'>" + error + "</span>"; // แสดงข้อผิดพลาดเป็นสีแดง
        };
    
        // ฟังก์ชันจัดการเมื่อดำเนินการสำเร็จ
        function onSuccess(response){
          info.innerHTML = "<span style='color:green'>" + response + "</span>"; // แสดงข้อความสำเร็จเป็นสีเขียว
          info2.innerHTML = "<span style='color:green'>" + response + "</span>"; // แสดงข้อความสำเร็จเป็นสีเขียว
          
              // เคลียร์ข้อมูลใน input elements
          document.querySelector('#Email').value = '';
          document.querySelector('#Type').value = '';
          document.querySelector('#Priority').value = '';
          document.querySelector('#Branch').value = ''; 
          document.querySelector('#Province').value = ''; 
          document.querySelector('#Date').value = ''; 
          document.querySelector('#Channel').value = ''; 
          document.querySelector('#Requestor').value = ''; 
          document.querySelector('#IA').value = ''; 
          document.querySelector('#Team').value = ''; 
          document.querySelector('#Owner').value = ''; 
          document.querySelector('#Complaint').value = ''; 
          document.querySelector('#Description').value = '';
          document.querySelector('#Assign').value = ''; 
          document.querySelector('#AuditObjective').value = ''; 
          document.querySelector('#Deadline').value = ''; 
          document.querySelector('#FieldWork').value = ''; 
          document.querySelector('#DraftReport').value = ''; 
          document.querySelector('#ReportReview').value = ''; 
          document.querySelector('#FinalReport').value = ''; 
          document.querySelector('#Notify').value = ''; 
          document.querySelector('#Result').value = ''; 
          document.querySelector('#Issue').value = '';
        };
    
        // เรียกใช้ฟังก์ชัน newEntry จาก Google Apps Script
        google.script.run.withFailureHandler(onFailure)
                         .withSuccessHandler(onSuccess)
                         .newEntry(sd); // ส่งข้อมูลไปยังฟังก์ชัน newEntry
      };
    </script>
<script>
    function read() {
      const txt = document.querySelector('#Search_ID').value.trim(); // ดึงค่าจากกล่องข้อความ Search_ID
      const info = document.querySelector('#result'); // ดึง element ที่ใช้แสดงผลลัพธ์
      const info2 = document.querySelector('#result2'); // ดึง element ที่ใช้แสดงผลลัพธ์
      
      // ตรวจสอบว่าผู้ใช้กรอก ID หรือไม่
      if (!txt) {
        info.innerHTML = "<span style='color:red'> กรุณากรอกหมายเลข ID เพื่อค้นหา</span>"; // แจ้งให้กรอก ID
        info2.innerHTML = "<span style='color:red'> กรุณากรอกหมายเลข ID เพื่อค้นหา</span>"; // แจ้งให้กรอก ID
        return;
      }
      
      // ฟังก์ชันจัดการเมื่อเกิดข้อผิดพลาด
      function onFailure(error) {
        info.innerHTML = `<span style='color:red'>${error}</span>`; // แสดงข้อผิดพลาดเป็นสีแดง
        info2.innerHTML = `<span style='color:red'>${error}</span>`; // แสดงข้อผิดพลาดเป็นสีแดง
      }
      
      // ฟังก์ชันจัดการเมื่อดำเนินการสำเร็จ
      function onSuccess(response) {
        // Update all fields at once
        const fields = {
          'Email': response[1],
          'Type': response[2],
          'Priority': response[3],
          'Branch': response[4],
          'Province': response[5],
          'Date': response[6],
          'Channel': response[7],
          'Requestor': response[8],
          'IA': response[9],
          'Team': response[10],
          'Owner': response[11],
          'Complaint': response[12],
          'Description': response[13],
          'AuditObjective': response[14],
          'Deadline': response[15],
          'Assign': response[16],
          'FieldWork': response[17],
          'DraftReport': response[18],
          'ReportReview': response[19],
          'FinalReport': response[20],
          'Notify': response[21],
          'Result': response[22],
          'Issue': response[23]
        };
  
        // Update the UI
        for (const [id, value] of Object.entries(fields)) {
          const element = document.getElementById(id);
          if (element) {
            element.value = value;
          }
        }
        
        info.innerHTML = `<span style='color:green'>${response[0]}</span>`; // แสดงข้อความสำเร็จเป็นสีเขียว
        info2.innerHTML = `<span style='color:green'>${response[0]}</span>`; // แสดงข้อความสำเร็จเป็นสีเขียว
      }
      
      info.innerHTML = " กำลังค้นหาข้อมูล..."; // แสดงข้อความว่า "กำลังอ่านข้อมูล"
      info2.innerHTML = " กำลังค้นหาข้อมูล..."; // แสดงข้อความว่า "กำลังอ่านข้อมูล"
      
      // เรียกใช้ฟังก์ชัน readId จาก Google Apps Script
      google.script.run.withFailureHandler(onFailure)
                       .withSuccessHandler(onSuccess)
                       .readId(txt); // ส่ง ID ไปยังฟังก์ชัน readId
    }
  </script>
<script>
    function showConfirmBox() {
      document.getElementById('confirm-overlay').style.display = 'flex';
    }
    function confirmUpdate() {
        document.getElementById('confirm-overlay').style.display = 'none';
        update(); // เรียกใช้ฟังก์ชัน update ถ้าผู้ใช้คลิก 'ยืนยัน'
    }

    function cancelUpdate() {
        document.getElementById('confirm-overlay').style.display = 'none'; // ซ่อนกล่องยืนยันถ้าผู้ใช้คลิก 'ยกเลิก'
    }

    function update() {
        let txt = document.querySelector('#Search_ID').value.trim(); // ID สำหรับการค้นหา
        let Email = document.querySelector('#Email').value.trim();
        let Type = document.querySelector('#Type').value.trim();
        let Priority = document.querySelector('#Priority').value.trim();
        let Branch = document.querySelector('#Branch').value.trim(); 
        let Province = document.querySelector('#Province').value.trim(); 
        let Date = document.querySelector('#Date').value.trim(); 
        let Channel = document.querySelector('#Channel').value.trim(); 
        let Requestor = document.querySelector('#Requestor').value.trim(); 
        let IA = document.querySelector('#IA').value.trim(); 
        let Team = document.querySelector('#Team').value.trim(); 
        let Owner = document.querySelector('#Owner').value.trim(); 
        let Complaint = document.querySelector('#Complaint').value.trim(); 
        let Description = document.querySelector('#Description').value.trim();
        let Assign = document.querySelector('#Assign').value.trim(); 
        let AuditObjective = document.querySelector('#AuditObjective').value.trim(); 
        let Deadline = document.querySelector('#Deadline').value.trim(); 
        let FieldWork = document.querySelector('#FieldWork').value.trim(); 
        let DraftReport = document.querySelector('#DraftReport').value.trim(); 
        let ReportReview = document.querySelector('#ReportReview').value.trim(); 
        let FinalReport = document.querySelector('#FinalReport').value.trim(); 
        let Notify = document.querySelector('#Notify').value.trim(); 
        let Result = document.querySelector('#Result').value.trim(); 
        let Issue = document.querySelector('#Issue').value.trim(); 

        var sd = [txt, Email, Type, Priority, Branch, Province, Date, Channel, Requestor, IA,
                 Team, Owner, Complaint, Description, AuditObjective, Deadline, "", "", "", "", "", "",
                 Assign, "", "", FieldWork, "", "", DraftReport, "", "", ReportReview, "", "",
                 FinalReport, "", "", Notify, "", Result, Issue]; // ส่งข้อมูลเป็นอาร์เรย์

        let info = document.querySelector('#result'); // ดึง element ที่ใช้แสดงผลลัพธ์
        let info2 = document.querySelector('#result2'); // ดึง element ที่ใช้แสดงผลลัพธ์

        if (txt === ""){
            info.innerHTML = "<span style='color:red'>กรุณากรอกหมายเลข ID เพื่ออัปเดตข้อมูล </span>"; // แจ้งให้กรอก ID สำหรับการอัปเดต
            info2.innerHTML = "<span style='color:red'>กรุณากรอกหมายเลข ID เพื่ออัปเดตข้อมูล </span>"; // แจ้งให้กรอก ID สำหรับการอัปเดต
        } else {
            function onFailure(error) {
                info.innerHTML = "<span style='color:red'>" + error + "</span>"; // แสดงข้อผิดพลาดเป็นสีแดง
                info2.innerHTML = "<span style='color:red'>" + error + "</span>"; // แสดงข้อผิดพลาดเป็นสีแดง
            };

            function onSuccess(response) {
                info.innerHTML = "<span style='color:green'>" + response + "</span>"; // แสดงข้อความสำเร็จเป็นสีเขียว
                info2.innerHTML = "<span style='color:green'>" + response + "</span>"; // แสดงข้อความสำเร็จเป็นสีเขียว
            };

            info.innerHTML = "กำลังอัปเดตข้อมูล..."; // แสดงข้อความว่า "กำลังอัปเดตข้อมูล"
            info2.innerHTML = "กำลังอัปเดตข้อมูล..."; // แสดงข้อความว่า "กำลังอัปเดตข้อมูล"

            // เคลียร์ข้อมูลใน input elements
            document.querySelector('#Email').value = '';
            document.querySelector('#Type').value = '';
            document.querySelector('#Priority').value = '';
            document.querySelector('#Branch').value = ''; 
            document.querySelector('#Province').value = ''; 
            document.querySelector('#Date').value = ''; 
            document.querySelector('#Channel').value = ''; 
            document.querySelector('#Requestor').value = ''; 
            document.querySelector('#IA').value = ''; 
            document.querySelector('#Team').value = ''; 
            document.querySelector('#Owner').value = ''; 
            document.querySelector('#Complaint').value = ''; 
            document.querySelector('#Description').value = '';
            document.querySelector('#Assign').value = ''; 
            document.querySelector('#AuditObjective').value = ''; 
            document.querySelector('#Deadline').value = ''; 
            document.querySelector('#FieldWork').value = ''; 
            document.querySelector('#DraftReport').value = ''; 
            document.querySelector('#ReportReview').value = ''; 
            document.querySelector('#FinalReport').value = ''; 
            document.querySelector('#Notify').value = ''; 
            document.querySelector('#Result').value = ''; 
            document.querySelector('#Issue').value = '';
            
            google.script.run.withFailureHandler(onFailure)
                             .withSuccessHandler(onSuccess)
                             .updateId(sd); // ส่งข้อมูลไปยังฟังก์ชัน updateId
        }
    }
</script>
<script>
    function clearAndRefresh() {
      // เคลียร์ข้อมูลใน input elements
      document.querySelector('#Search_ID').value = '';
      document.querySelector('#Email').value = '';
      document.querySelector('#Type').value = '';
      document.querySelector('#Priority').value = '';
      document.querySelector('#Branch').value = ''; 
      document.querySelector('#Province').value = ''; 
      document.querySelector('#Date').value = ''; 
      document.querySelector('#Channel').value = ''; 
      document.querySelector('#Requestor').value = ''; 
      document.querySelector('#IA').value = ''; 
      document.querySelector('#Team').value = ''; 
      document.querySelector('#Owner').value = ''; 
      document.querySelector('#Complaint').value = ''; 
      document.querySelector('#Description').value = '';
      document.querySelector('#Assign').value = ''; 
      document.querySelector('#AuditObjective').value = ''; 
      document.querySelector('#Deadline').value = ''; 
      document.querySelector('#FieldWork').value = ''; 
      document.querySelector('#DraftReport').value = ''; 
      document.querySelector('#ReportReview').value = ''; 
      document.querySelector('#FinalReport').value = ''; 
      document.querySelector('#Notify').value = ''; 
      document.querySelector('#Result').value = ''; 
      document.querySelector('#Issue').value = '';
        // แสดงข้อความว่า "กำลังเคลียร์ข้อมูล"
        const info = document.querySelector('#result');
        const info2 = document.querySelector('#result2');
        info.innerHTML = "";
        info2.innerHTML = "";

    }
</script>
<br>
<div class="head">
      <img src="https://www.thailife.com/public/assets/images/LOGO-THAILIFE.jpg" style="width: 60px; height: 60px" alt="logo web" >
      <h1>CONSULTING SERVICES FORMS</h1>
</div>
<!-- <h1>CONSULTING SERVICES FORMS</h1> -->

    <div class="mid">
      <div class="col">
        <label for="Search_ID"></label>
         <input type="text" id="Search_ID" class="form-group" placeholder="Search_ID">
        <button id="search" type="button" onclick="read()">Search</button> <p>
      </div>
        <!-- <tr> -->
          <td colspan="2" class="mid"><b id="result"></b></td> <!-- พื้นที่สำหรับแสดงผลการดำเนินการ -->
        <!-- </tr> -->
    </div>
<br>
  <div class="container-fluid-1">
    <h3>INFORMATION OF CONSULTING</h3>
    <div class="row g-3">
      <!-- <div class="col-md-4">
        <div class="form-floating">
          <label for="Plan_ID">Plan ID:</label>
          <input type="text" class="form-control" id="Plan_ID">
        </div>
      </div> -->
      <div class="col">
        <div class="form-floating">
          <label for="Email">Email:</label>
          <input type="email" class="form-control" id="Email">
        </div>
      </div>
      <div class="col">
        <div class="form-floating">
          <label for="Type">Type:</label>
          <select class="form-control" id="Type">
            <option value="" disabled selected>Select Type</option>
            <option value="Investigation">Investigation</option>
            <option value="Complaint">Complaint</option>
            <option value="Whistleblower">Whistleblower</option>
            <option value="Advisory">Advisory</option>
          </select>
        </div>
      </div>
    </div>
    <div class="row g-2">
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Priority">Priority:</label>
          <select class="form-control" id="Priority">
            <option value="" disabled selected>Select Priority</option>
            <option value="High">High</option>
            <option value="Moderate">Moderate</option>
            <option value="Low">Low</option>
          </select>
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Branch">Branch:</label>
          <input type="text" class="form-control" id="Branch">
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Province">Province:</label>
          <input type="text" class="form-control" id="Province">
        </div>
      </div>
    </div>
    <div class="row g-2">
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Date">Date:</label>
          <input type="date" class="form-control" id="Date">
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Channel">Channel:</label>
          <input type="text" class="form-control" id="Channel">
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Requestor">Requestor:</label>
          <input type="text" class="form-control" id="Requestor">
        </div>
      </div>
    </div>
    <div class="row g-2">
      <div class="col-md-4">
        <div class="form-floating">
          <label for="IA">IA (Auditor):</label>
          <input type="text" class="form-control" id="IA">
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Team">Team:</label>
          <input type="text" class="form-control" id="Team">
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Owner">Owner:</label>
          <input type="text" class="form-control" id="Owner">
        </div>
      </div>
    </div>
    <div class="row g-2">
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Complaint">Complaint:</label>
          <input type="text" class="form-control" id="Complaint">
        </div>
      </div>
      <div class="col-md-8">
        <div class="form-floating">
          <label for="Description">Description:</label>
          <textarea class="form-control" id="Description"></textarea>
        </div>
      </div>
    </div>
    <br>
  </div>
<br>
  <div class="container-fluid-2">
    <h3>DATE OF STATUS PROCESS</h3>
    <div class="row g-2">
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Assign">Assign:</label>
          <input type="date" class="form-control" id="Assign">
        </div>
      </div>
      <div class="col-md-8">
        <div class="form-floating">
          <label for="Audit Objective">Audit Objective:</label>
          <textarea class="form-control" id="AuditObjective"></textarea>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="form-floating">
          <label for="Deadline">Deadline:</label>
          <input type="date" class="form-control" id="Deadline">
        </div>
      </div>
      <div class="col">
        <div class="form-floating">
          <label for="Field Work">Field Work:</label>
          <input type="date" class="form-control" id="FieldWork">
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="form-floating">
          <label for="Draft Report">Draft Report:</label>
          <input type="date" class="form-control" id="DraftReport">
        </div>
      </div>
      <div class="col">
        <div class="form-floating">
          <label for="Report Review">Report Review:</label>
          <input type="date" class="form-control" id="ReportReview">
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="form-floating">
          <label for="Final Report">Final Report:</label>
          <input type="date" class="form-control" id="FinalReport">
        </div>
      </div>
      <div class="col">
        <div class="form-floating">
          <label for="Notify">Notify:</label>
          <input type="date" class="form-control" id="Notify">
        </div>
      </div>
    </div>
  </div>
<br>
  <div class="container-fluid-3">
    <h3>RESULT</h3>
    <div class="row g-2">
      <div class="col-md-4">
        <div class="form-floating">
          <label for="Result">Result:</label>
           <select class="form-control" id="Result">
            <option value="" disabled selected>Select Result</option>
            <option value="Issue Found">Issue Found</option>
            <option value="No Issue">No Issue</option>
            <option value="No Audit">No Audit</option>
          </select>
        </div>
      </div>
      <div class="col-md-8">
        <div class="form-floating">
          <label for="Issue">Issue:</label>
          <textarea class="form-control" id="Issue"></textarea>
        </div>
      </div>
    </div>
  </div>
  <br>
  <div class="mid">
    <td class="mid"><b id="result2"></b></td> <!-- พื้นที่สำหรับแสดงผลการดำเนินการที่สอง -->
    <div class="button-container">
            <button id="update" type="button" onclick="showConfirmBox()">Update</button>
        <button id="submit" type="button" onclick="showSubmitBox()">Save</button>
        <button id="clear" type="button" onclick="clearAndRefresh()">Clear</button>
  </div>

  <div id="confirm-overlay" class="overlay">
    <div class="confirm-box">
      <div class="button-container">
        <h5> ท่านยืนยันจะอัปเดตข้อมูลหรือไม่</h5> 
        <h6> ข้อมูลจะถูกบันทึกทับข้อมูลเดิมที่มีอยู่ทั้งหมด </h6>
            <button class="confirm" onclick="confirmUpdate()">ยืนยัน</button>
            <button class="cancel" onclick="cancelUpdate()">ยกเลิก</button>
      </div>
    </div>
  </div>
    <div id="confirm-overlay-save" class="overlay">
    <div class="confirm-box">
      <div class="button-container">
        <h5> ท่านยืนยันจะบันทึกข้อมูลหรือไม่</h5>
        <h6> กรุณาตรวจสอบข้อมูลเพื่อความถูกต้อง </h6>
            <button class="confirm" onclick="confirmSaubmit()">ยืนยัน</button>
            <button class="cancel" onclick="cancelSubmit()">ยกเลิก</button>
      </div>
    </div>
  </div>
</div>
  <div class="mid">
    <span style='color:red' font-weight= bold>หมายเหตุ : ก่อนจะอัปเดตเคสทุกครั้งต้องเสิร์ชข้อมูลขึ้นมาก่อน!</span>
  </div>
  <div id="result" class="text-center mt-3"></div>

    <script>
        const scriptURL = 'https://script.google.com/a/macros/thailife.com/s/AKfycbzKz074guyjsjDUtkzBzAuv8FpA5uG_APXSRzUk23qjIoVgEY85RtF7-RfGc5Rxf7rB/exec'
        const from = document.frrom['DataBase_Consulting']

        form.addEventListener('submit', e => {
              e.preventDefault()
              fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => alert("บันทึกข้อมูลเรียบร้อยแล้ว.."))
                .catch(error => console.error('Error!', error.message))
            })
    </script>

</body>
</html>