<script>
    function showSubmitBox() {
      document.getElementById('confirm-overlay-save').style.display = 'flex';
    }
    function confirmSaubmit() {
        document.getElementById('confirm-overlay-save').style.display = 'none';
        submit(); // เรียกใช้ฟังก์ชัน submit ถ้าผู้ใช้คลิก 'ยืนยัน'
    }

    function cancelSubmit() {
        document.getElementById('confirm-overlay-save').style.display = 'none'; // ซ่อนกล่องยืนยันถ้าผู้ใช้คลิก 'ยกเลิก'
    }

  function submit(){
    // ดึงค่าจาก input elements
    // let tx1 = document.querySelector('#Plan_ID').value;
    let Email = document.querySelector('#Email').value;
    let Type = document.querySelector('#Type').value;
    let Priority = document.querySelector('#Priority').value;
    let Branch = document.querySelector('#Branch').value; 
    let Province = document.querySelector('#Province').value; 
    let Date = document.querySelector('#Date').value; 
    let Channel = document.querySelector('#Channel').value; 
    let Requestor = document.querySelector('#Requestor').value; 
    let IA = document.querySelector('#IA').value; 
    let Team = document.querySelector('#Team').value; 
    let Owner = document.querySelector('#Owner').value; 
    let Complaint = document.querySelector('#Complaint').value; 
    let Description = document.querySelector('#Description').value;

    let Assign = document.querySelector('#Assign').value; 
    let AuditObjective = document.querySelector('#AuditObjective').value; 
    let Deadline = document.querySelector('#Deadline').value; 
    let FieldWork = document.querySelector('#FieldWork').value; 
    let DraftReport = document.querySelector('#DraftReport').value; 
    let ReportReview = document.querySelector('#ReportReview').value; 
    let FinalReport = document.querySelector('#FinalReport').value; 
    let Notify = document.querySelector('#Notify').value; 
    
    let Result = document.querySelector('#Result').value; 
    let Issue = document.querySelector('#Issue').value; 

    var sd = [Email, Type, Priority, Branch, Province, Date, Channel, Requestor, IA, Team, Owner, Complaint, Description, AuditObjective, Deadline,"","","","","","", Assign,"","", FieldWork,"","", DraftReport,"","", ReportReview,"","", FinalReport,"","", Notify,"", Result, Issue]; // ส่งข้อมูลเป็นอาร์เรย์
    
    let info = document.querySelector('#result'); // ดึง element ที่ใช้แสดงผลลัพธ์
    let info2 = document.querySelector('#result2'); // ดึง element ที่ใช้แสดงผลลัพธ์
    info.innerHTML = "กำลังบันทึกข้อมูล..."; // แสดงข้อความว่า "กำลังเพิ่มข้อมูลใหม่"
    info2.innerHTML = "กำลังบันทึกข้อมูล..."; // แสดงข้อความว่า "กำลังเพิ่มข้อมูลใหม่"

    // ฟังก์ชันจัดการเมื่อเกิดข้อผิดพลาด
    function onFailure(error){
      info.innerHTML = "<span style='color:red'>" + error + "</span>"; // แสดงข้อผิดพลาดเป็นสีแดง
      info2.innerHTML = "<span style='color:red'>" + error + "</span>"; // แสดงข้อผิดพลาดเป็นสีแดง
    };

    // ฟังก์ชันจัดการเมื่อดำเนินการสำเร็จ
    function onSuccess(response){
      info.innerHTML = "<span style='color:green'>" + response + "</span>"; // แสดงข้อความสำเร็จเป็นสีเขียว
      info2.innerHTML = "<span style='color:green'>" + response + "</span>"; // แสดงข้อความสำเร็จเป็นสีเขียว
      
          // เคลียร์ข้อมูลใน input elements
      document.querySelector('#Email').value = '';
      document.querySelector('#Type').value = '';
      document.querySelector('#Priority').value = '';
      document.querySelector('#Branch').value = ''; 
      document.querySelector('#Province').value = ''; 
      document.querySelector('#Date').value = ''; 
      document.querySelector('#Channel').value = ''; 
      document.querySelector('#Requestor').value = ''; 
      document.querySelector('#IA').value = ''; 
      document.querySelector('#Team').value = ''; 
      document.querySelector('#Owner').value = ''; 
      document.querySelector('#Complaint').value = ''; 
      document.querySelector('#Description').value = '';
      document.querySelector('#Assign').value = ''; 
      document.querySelector('#AuditObjective').value = ''; 
      document.querySelector('#Deadline').value = ''; 
      document.querySelector('#FieldWork').value = ''; 
      document.querySelector('#DraftReport').value = ''; 
      document.querySelector('#ReportReview').value = ''; 
      document.querySelector('#FinalReport').value = ''; 
      document.querySelector('#Notify').value = ''; 
      document.querySelector('#Result').value = ''; 
      document.querySelector('#Issue').value = '';
    };

    // เรียกใช้ฟังก์ชัน newEntry จาก Google Apps Script
    google.script.run.withFailureHandler(onFailure)
                     .withSuccessHandler(onSuccess)
                     .newEntry(sd); // ส่งข้อมูลไปยังฟังก์ชัน newEntry
  };
</script>
